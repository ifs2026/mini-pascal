# ğŸ“— Entrega 3: Analisador SintÃ¡tico e SemÃ¢ntico (Parser)

**Compilador Mini-Pascal - IFS Campus Itabaiana 2025.2**

*Disciplina: LINGUAGENS FORMAIS, AUTÃ”MATOS E COMPILADORES*

---

## ğŸ“… InformaÃ§Ãµes da Entrega

|       Item      |                          DescriÃ§Ã£o                              |
|-----------------|-----------------------------------------------------------------|
| Data de Entrega | 28/01/2026                                                      |
| Objetivo        | Validar estrutura gramatical e verificar consistÃªncia semÃ¢ntica |
| Status          | âœ… ConcluÃ­do                                                   |

---

## ğŸ“‹ Ãndice

- [Objetivo](#objetivo)
- [Conceito](#conceito)
- [Artefatos Entregues](#artefatos-entregues)
- [Analisador SintÃ¡tico](#analisador-sintÃ¡tico)
- [Analisador SemÃ¢ntico](#analisador-semÃ¢ntico)
- [Tabela de SÃ­mbolos](#tabela-de-sÃ­mbolos)
- [Sistema de Tipos](#sistema-de-tipos)
- [Exemplos de ValidaÃ§Ã£o](#exemplos-de-validaÃ§Ã£o)
- [Testes Implementados](#testes-implementados)
- [Como Executar](#como-executar)
- [RelatÃ³rios Gerados](#relatÃ³rios-gerados)

---

## ğŸ¯ Objetivo

Esta entrega implementa **duas camadas crÃ­ticas** do compilador:

### 1ï¸âƒ£ Analisador SintÃ¡tico (Parser)
- Validar se a sequÃªncia de tokens obedece Ã  gramÃ¡tica BNF definida na Entrega 1
- Gerar a Ãrvore SintÃ¡tica Abstrata (AST)
- Detectar erros sintÃ¡ticos com mensagens descritivas

### 2ï¸âƒ£ Analisador SemÃ¢ntico
- Verificar compatibilidade de tipos em operaÃ§Ãµes
- Validar declaraÃ§Ã£o de variÃ¡veis antes do uso
- Controlar escopos (variÃ¡veis locais vs. globais)
- Detectar redeclaraÃ§Ãµes de variÃ¡veis

---

## ğŸ’¡ Conceito

### AnÃ¡lise SintÃ¡tica
> "O parser verifica se a estrutura do cÃ³digo estÃ¡ correta. Ã‰ como verificar se uma frase em portuguÃªs tem sujeito, verbo e predicado na ordem certa."

**Exemplo de Erro SintÃ¡tico:**
```pascal
if x > 10 print('erro');  // âŒ Falta "then"

AnÃ¡lise SemÃ¢ntica
"O analisador semÃ¢ntico verifica se o cÃ³digo faz sentido. 
Ã‰ como verificar se uma frase gramaticalmente correta tambÃ©m tem lÃ³gica."

Exemplos de Erros SemÃ¢nticos:
âŒ "Estou tentando somar um nÃºmero com um texto?"
âŒ "A variÃ¡vel x foi declarada antes de ser usada?"
âŒ "Estou atribuindo um valor real a uma variÃ¡vel integer?"

## ğŸ“¦ Artefatos Entregues

### Arquivos Principais

| Arquivo                          | LocalizaÃ§Ã£o                        | DescriÃ§Ã£o                                 |
|----------------------------------|------------------------------------|-------------------------------------------|
| `miniPascalParser.java`          | `target/generated-sources/antlr4/` | Parser gerado pelo ANTLR                  |
| `MiniPascalSemanticVisitor.java` | `src/main/java/`                   | Visitor para anÃ¡lise semÃ¢ntica            |
| `SymbolTable.java`               | `src/main/java/`                   | Tabela de sÃ­mbolos com suporte a escopos  |
| `Type.java`                      | `src/main/java/`                   | EnumeraÃ§Ã£o de tipos da linguagem          |
| `SemanticException.java`         | `src/main/java/`                   | ExceÃ§Ã£o customizada para erros semÃ¢nticos |
| `MiniPascalParserTest.java`      | `src/test/java/`                   | Testes unitÃ¡rios do parser                |
| `README_ENTREGA3.md`             | Raiz do projeto                    | Este documento                            |


### Arquivos Gerados

| Arquivo          | LocalizaÃ§Ã£o                      | DescriÃ§Ã£o                   |
|------------------|----------------------------------|-----------------------------|
| Ãrvores de Parse | `test-reports/parse-trees/`      | RepresentaÃ§Ã£o visual da AST |
| Erros SemÃ¢nticos | `test-reports/semantic-errors/`  | Log de erros detectados     |
| RelatÃ³rios JUnit | `test-reports/`                  | Resultados dos testes       |

## ğŸŒ³ Analisador SintÃ¡tico

### Funcionalidades Implementadas

| Funcionalidade         | DescriÃ§Ã£o                                    | Status           |
|------------------------|----------------------------------------------|------------------|
| ValidaÃ§Ã£o de Estrutura | Verifica conformidade com gramÃ¡tica BNF      | âœ… Implementado |
| GeraÃ§Ã£o de AST         | Cria Ã¡rvore sintÃ¡tica abstrata               | âœ… Implementado |
| DetecÃ§Ã£o de Erros      | Identifica erros sintÃ¡ticos com linha/coluna | âœ… Implementado |
| Mensagens Descritivas  | Erros com contexto e sugestÃµes               | âœ… Implementado |

### Regras SintÃ¡ticas Validadas

// Estrutura do Programa
program
    : PROGRAM identifier SEMICOLON 
      variableDeclarationPart? 
      compoundStatement DOT EOF
    ;

// DeclaraÃ§Ã£o de VariÃ¡veis
variableDeclarationPart
    : VAR variableDeclaration (SEMICOLON variableDeclaration)* SEMICOLON?
    ;

// Comandos
statement
    : assignmentStatement
    | ifStatement
    | whileStatement
    | forStatement
    | ioStatement
    | compoundStatement
    | // vazio
    ;

// ExpressÃµes com PrecedÃªncia
expression
    : simpleExpression (relationalOperator simpleExpression)?
    ;

simpleExpression
    : term (additiveOperator term)*
    ;

term
    : factor (multiplicativeOperator factor)*
    ;


// Exemplo de DetecÃ§Ã£o de Erro SintÃ¡tico
// CÃ³digo InvÃ¡lido:

program Teste;
var x: integer
begin  // âŒ ERRO: Falta ';' apÃ³s declaraÃ§Ã£o de variÃ¡vel
  x := 10;
end.

Mensagem de Erro:
line 2:14 mismatched input 'begin' expecting {';', ','}
âŒ ERRO DE SINTAXE: Esperado ';' apÃ³s declaraÃ§Ã£o de variÃ¡vel

## ğŸ”¬ Analisador SemÃ¢ntico

### Funcionalidades Implementadas

| Funcionalidade           | DescriÃ§Ã£o                                       | Status           |
|--------------------------|-------------------------------------------------|------------------|
| VerificaÃ§Ã£o de Tipos     | Valida compatibilidade em operaÃ§Ãµes             | âœ… Implementado |
| DeclaraÃ§Ã£o de VariÃ¡veis  | Verifica se variÃ¡vel foi declarada antes do uso | âœ… Implementado |
| Controle de Escopos      | Gerencia escopos aninhados (global/local)       | âœ… Implementado |
| DetecÃ§Ã£o de RedeclaraÃ§Ã£o | Impede declarar mesma variÃ¡vel duas vezes       | âœ… Implementado |


// ImplementaÃ§Ã£o do Visitor SemÃ¢ntico

Arquivo: src/main/java/MiniPascalSemanticVisitor.java

public class MiniPascalSemanticVisitor extends miniPascalBaseVisitor<Type> {
    private SymbolTable symbolTable;

    public MiniPascalSemanticVisitor() {
        this.symbolTable = new SymbolTable();
    }

    @Override
    public Type visitVariableDeclaration(miniPascalParser.VariableDeclarationContext ctx) {
        Type varType = getType(ctx.type());
        
        for (var idCtx : ctx.identifierList().identifier()) {
            String varName = idCtx.getText();
            
            // Verifica redeclaraÃ§Ã£o
            try {
                symbolTable.declare(varName, varType);
            } catch (SemanticException e) {
                System.err.println("ERRO SEMÃ‚NTICO linha " + ctx.start.getLine() + 
                                   ": " + e.getMessage());
            }
        }
        return null;
    }

    @Override
    public Type visitAssignmentStatement(miniPascalParser.AssignmentStatementContext ctx) {
        String varName = ctx.identifier().getText();
        
        // Verifica se variÃ¡vel foi declarada
        Type varType;
        try {
            varType = symbolTable.lookup(varName);
        } catch (SemanticException e) {
            System.err.println("ERRO SEMÃ‚NTICO linha " + ctx.start.getLine() + 
                               ": Variavel '" + varName + "' nao declarada");
            return null;
        }
        
        // Verifica tipo da expressÃ£o
        Type exprType = visit(ctx.expression());
        
        if (varType != exprType && exprType != null) {
            System.err.println("ERRO SEMÃ‚NTICO linha " + ctx.start.getLine() + 
                               ": Tipos incompativeis na atribuicao");
        }
        
        return null;
    }
}

ğŸ“Š Tabela de SÃ­mbolos
ğŸ“Š Estrutura

Arquivo: src/main/java/SymbolTable.java

public class SymbolTable {
    private List<Map<String, Type>> scopes;
    
    public SymbolTable() {
        scopes = new ArrayList<>();
        enterScope(); // Escopo global
    }
    
    public void enterScope() {
        scopes.add(new HashMap<>());
    }
    
    public void exitScope() {
        if (scopes.size() > 1) {
            scopes.remove(scopes.size() - 1);
        }
    }
    
    public void declare(String name, Type type) throws SemanticException {
        Map<String, Type> currentScope = scopes.get(scopes.size() - 1);
        
        if (currentScope.containsKey(name)) {
            throw new SemanticException("Variavel '" + name + "' ja declarada neste escopo");
        }
        
        currentScope.put(name, type);
    }
    
    public Type lookup(String name) throws SemanticException {
        // Busca do escopo mais interno para o mais externo
        for (int i = scopes.size() - 1; i >= 0; i--) {
            if (scopes.get(i).containsKey(name)) {
                return scopes.get(i).get(name);
            }
        }
        
        throw new SemanticException("Variavel '" + name + "' nao declarada");
    }
}


### Funcionalidades

| MÃ©todo                | DescriÃ§Ã£o                                                            |
|-----------------------|----------------------------------------------------------------------|
| `enterScope()`        | Cria novo escopo (ao entrar em bloco `begin...end`)                  |
| `exitScope()`         | Remove escopo atual (ao sair de bloco)                               |
| `declare(name, type)` | Declara variÃ¡vel no escopo atual                                     |
| `lookup(name)`        | Busca variÃ¡vel em todos os escopos (do mais interno ao mais externo) |


ğŸ¨ Sistema de Tipos

Arquivo: src/main/java/Type.java

public enum Type {
    INTEGER,    // NÃºmeros inteiros
    REAL,       // NÃºmeros reais (ponto flutuante)
    STRING,     // Texto
    BOOLEAN,    // Verdadeiro/Falso
    VOID        // Sem tipo (para comandos)
}


### Regras de Compatibilidade

| OperaÃ§Ã£o                        | Tipos Aceitos         | Tipo Resultante | Exemplo           |
|---------------------------------|-----------------------|-----------------|-------------------|
| `+`, `-`, `*`, `/`              | `INTEGER` + `INTEGER` | `INTEGER`       | `5 + 3 = 8`       |
| `+`, `-`, `*`, `/`              | `REAL` + `REAL`       | `REAL`          | `5.5 + 2.3 = 7.8` |
| `+`, `-`, `*`, `/`              | `INTEGER` + `REAL`    | `REAL`          | `5 + 2.5 = 7.5`   |
| `=`, `<>`, `<`, `>`, `<=`, `>=` | Mesmo tipo            | `BOOLEAN`       | `x > 10`          |
| `and`, `or`, `not`              | `BOOLEAN`             | `BOOLEAN`       | `true and false`  |

âœ… Exemplos de ValidaÃ§Ã£o

Exemplo 1: Programa VÃ¡lido
program ExemploValido;
var
    x, y: integer;
    z: real;
begin
    x := 10;
    y := 20;
    z := x + y;  // âœ… OK: INTEGER + INTEGER = INTEGER, atribuÃ­do a REAL
    
    if z > 15.0 then
        print('Maior que 15');
end.

AnÃ¡lise SemÃ¢ntica:

âœ… Todas as variÃ¡veis declaradas antes do uso
âœ… Tipos compatÃ­veis nas operaÃ§Ãµes
âœ… ConversÃ£o implÃ­cita de INTEGER para REAL permitida

Exemplo 2: VariÃ¡vel NÃ£o Declarada
program ErroNaoDeclarada;
begin
    x := 10;  // âŒ ERRO: 'x' nÃ£o foi declarada
end.

SaÃ­da:
âŒ ERRO SEMÃ‚NTICO linha 3: Variavel 'x' nao declarada

Exemplo 3: RedeclaraÃ§Ã£o de VariÃ¡vel
program ErroRedeclaracao;
var
    x: integer;
    x: real;  // âŒ ERRO: 'x' jÃ¡ foi declarada
begin
    x := 10;
end.

SaÃ­da:
âŒ ERRO SEMÃ‚NTICO linha 4: Variavel 'x' ja declarada neste escopo


Exemplo 4: Tipos IncompatÃ­veis
program ErroTipos;
var
    x: integer;
    nome: string;
begin
    x := nome;  // âŒ ERRO: NÃ£o pode atribuir STRING a INTEGER
end.

SaÃ­da:
âŒ ERRO SEMÃ‚NTICO linha 6: Tipos incompativeis na atribuicao

Exemplo 5: Escopos Aninhados
program ExemploEscopos;
var
    x: integer;
begin
    x := 10;  // âœ… VariÃ¡vel global
    
    begin
        var y: integer;
        y := 20;  // âœ… VariÃ¡vel local
        x := x + y;  // âœ… Acessa variÃ¡vel global
    end;
    
    print(x);  // âœ… OK
    print(y);  // âŒ ERRO: 'y' nÃ£o existe fora do escopo interno
end.


ğŸ§ª Testes Implementados

Arquivo: src/test/java/MiniPascalParserTest.java

### Testes SintÃ¡ticos

| Teste                         | DescriÃ§Ã£o                        | Status     |
|-------------------------------|----------------------------------|------------|
| `testProgramaValido()`        | Valida programa completo         | âœ… Passou |
| `testIfElse()`                | Valida estrutura condicional     | âœ… Passou |
| `testWhile()`                 | Valida laÃ§o while                | âœ… Passou |
| `testFor()`                   | Valida laÃ§o for (to/downto)      | âœ… Passou |
| `testExpressoesAritmeticas()` | Valida precedÃªncia de operadores | âœ… Passou |
| `testErroSintaxe()`           | Detecta erro sintÃ¡tico           | âœ… Passou |


### Testes SemÃ¢nticos

| Teste                        | DescriÃ§Ã£o                             | Status     |
|------------------------------|---------------------------------------|------------|
| `testVariavelNaoDeclarada()` | Detecta uso de variÃ¡vel nÃ£o declarada | âœ… Passou |
| `testRedeclaracao()`         | Detecta redeclaraÃ§Ã£o de variÃ¡vel      | âœ… Passou |
| `testTiposIncompativeis()`   | Detecta incompatibilidade de tipos    | âœ… Passou |
| `testEscoposAninhados()`     | Valida controle de escopos            | âœ… Passou |


ğŸš€ Executar Testes
# Todos os testes do parser

mvn test -Dtest=MiniPascalParserTest

# Teste especÃ­fico
mvn test -Dtest=MiniPascalParserTest#testVariavelNaoDeclarada

ğŸš€ Como Executar
Passo 1: Compilar o Projeto

mvn clean compile

Passo 2: Executar Menu Interativo

mvn exec:java
ou
java -cp target/classes Main

Selecionar OpÃ§Ã£o 5:
5 - Testes apenas do Parser

Passo 3: Demo de AnÃ¡lise SemÃ¢ntica
Selecionar OpÃ§Ã£o 7:
7 - Demo SemÃ¢ntica (tabela de sÃ­mbolos + escopos)

SaÃ­da Esperada:
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   DEMO SEMÃ‚NTICA (Tabela de SÃ­mbolos + Escopos)        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Œ Escopo global:
âœ… Declarado: x (INTEGER), y (REAL), nome (STRING)

ğŸ” Lookup: x = INTEGER

ğŸ” Lookup invÃ¡lido: z = âœ… OK - Variavel 'z' nao declarada

ğŸ“Œ Entrando em escopo interno:
âœ… Declarado: contador (INTEGER) no escopo local

ğŸ” Lookup contador (interno): INTEGER

ğŸ” Lookup x (visÃ­vel do global): INTEGER

âœ… SimulaÃ§Ã£o de atribuiÃ§Ã£o: contador := contador + 1 (vÃ¡lido)

ğŸ” Tentativa de redeclaraÃ§Ã£o: contador jÃ¡ existe â†’ âœ… OK - Variavel 'contador' ja declarada neste escopo

ğŸ“Œ Saindo do escopo interno:

ğŸ” Lookup contador (fora do escopo): âœ… OK - Variavel 'contador' nao declarada

âœ… Demo finalizada!

ğŸ“‚ RelatÃ³rios Gerados
LocalizaÃ§Ã£o dos Arquivos

test-reports/
â”œâ”€â”€ parse-trees/                    # Ãrvores sintÃ¡ticas
â”‚   â”œâ”€â”€ teste1_programa_valido_tree.txt
â”‚   â”œâ”€â”€ teste2_if_else_tree.txt
â”‚   â”œâ”€â”€ teste3_while_tree.txt
â”‚   â”œâ”€â”€ teste4_for_tree.txt
â”‚   â””â”€â”€ teste5_expressoes_tree.txt
â”‚
â”œâ”€â”€ semantic-errors/                # Erros semÃ¢nticos
â”‚   â”œâ”€â”€ test_variavel_nao_declarada.txt
â”‚   â”œâ”€â”€ test_redeclaracao.txt
â”‚   â””â”€â”€ test_tipos_incompativeis.txt
|
â”‚                                   # RelatÃ³rios JUnit
â”œâ”€â”€ MiniPascalParserTest.txt
â””â”€â”€ TEST-MiniPascalParserTest.xml

Exemplo de Ãrvore SintÃ¡tica
Arquivo: test-reports/parse-trees/teste1_programa_valido_tree.txt

(program 
  program ExemploValido ; 
  (variableDeclarationPart 
    var 
    (variableDeclaration 
      (identifierList x , y) : integer) ;) 
  (compoundStatement 
    begin 
    (statement 
      (assignmentStatement x := (expression (simpleExpression (term (factor 10)))))) ; 
    (statement 
      (assignmentStatement y := (expression (simpleExpression (term (factor 20)))))) 
    end) 
  . 
  <EOF>)

## ğŸ¯ Resumo da Entrega

| Item                | Status                    |
|---------------------|---------------------------|
| Parser Implementado | âœ… Completo              |
| AST Gerada          | âœ… Sim                   |
| AnÃ¡lise SemÃ¢ntica   | âœ… Completa              |             
| Tabela de SÃ­mbolos  | âœ… Com suporte a escopos |
| Sistema de Tipos    | âœ… 4 tipos implementados |
| Testes UnitÃ¡rios    | âœ… 10 testes passando    |
| RelatÃ³rios Gerados  | âœ… Ãrvores e erros       |
| DocumentaÃ§Ã£o        | âœ… Completa              |

## ğŸ“ Conceitos Aplicados

| Conceito             | DescriÃ§Ã£o                                  | ImplementaÃ§Ã£o                     |
|----------------------|--------------------------------------------|-----------------------------------|
| AST                  | Ãrvore SintÃ¡tica Abstrata                  | Gerada automaticamente pelo ANTLR |
| Visitor Pattern      | PadrÃ£o de projeto para travessia da AST    | `MiniPascalSemanticVisitor.java`  |
| Tabela de SÃ­mbolos   | Estrutura para armazenar variÃ¡veis e tipos | `SymbolTable.java`                |
| Escopos Aninhados    | Suporte a blocos `begin...end`             | `enterScope()` / `exitScope()`    |
| VerificaÃ§Ã£o de Tipos | Compatibilidade em operaÃ§Ãµes               | Regras no Visitor                 |

ğŸ“š ReferÃªncias

Dragon Book: Compilers: Principles, Techniques, and Tools (Aho, Sethi, Ullman)
ANTLR 4 Documentation: https://www.antlr.org/
Visitor Pattern: Design Patterns (Gang of Four)

## ğŸ“ HistÃ³rico de VersÃµes

| VersÃ£o | Data       | DescriÃ§Ã£o                 | Autor              |
|--------|------------|---------------------------|--------------------|
| 1.0    | 28/01/2026 | VersÃ£o inicial da entrega | Equipe Mini-Pascal |

ğŸ‘¥ Autores

Enaldo Dantas  - jose.santos259@academico.ifs.edu.br
Agnaldo Neto   - jose.neto044@academico.ifs.edu.br
Vitorio Mota   - vitorio.mota085@academico.ifs.edu.br
Lucas Oliveira - lucas.oliveira031@academico.ifs.edu.br

ğŸ“ ContatoPara dÃºvidas sobre esta entrega:
Email: jeds@outlook.com.br
GitHub: https://github.com/ifs2026

Entrega 3 concluÃ­da com sucesso! âœ…
Desenvolvido para IFS Campus Itabaiana - 2025.2
Disciplina: LINGUAGENS FORMAIS, AUTÃ”MATOS E COMPILADORES
